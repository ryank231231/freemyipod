NAME ?= iloader-theme-default

ILOADER = ../..
ASSETPATH = iLoader/theme
SOURCEPATH = source

UCL2E10SINGLEBLK = ucl2e10singleblk
COMPILECONFIG = python $(ILOADER)/tools/compileconfig.py
ZIP = zip -r

CONFIG = iLoader/iloader.cfg
CONFIGSRC = $(SOURCEPATH)/iloader.conf
ASSETS = $(ASSETPATH)/menu.ucl $(ASSETPATH)/backdrop.ucl $(ASSETPATH)/booting.ucl $(ASSETPATH)/rockbox.ucl $(ASSETPATH)/apple.ucl
ZIPFILE = $(NAME).zip

all: $(ZIPFILE)

$(ZIPFILE): $(ASSETS) $(CONFIG)
	@echo [ZIP]    $@
	@rm -f $(ZIPFILE)
	@$(ZIP) --exclude='*/.svn/*' $@ iLoader

$(CONFIG): $(CONFIGSRC)
	@echo [CCONF]  $<
	@$(COMPILECONFIG) $< $@

$(ASSETPATH)/%.ucl: $(SOURCEPATH)/%.bmp
	@echo [UCL]    $<
	@$(UCL2E10SINGLEBLK) $< $@

.PHONY: all clean dist

clean:
	@$(RM) $(CONFIG) $(ASSETS) $(ZIPFILE)

dist: all
	@$(RM) $(CONFIG) $(ASSETS)
